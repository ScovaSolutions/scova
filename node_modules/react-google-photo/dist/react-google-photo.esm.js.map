{"version":3,"file":"react-google-photo.esm.js","sources":["../src/arrow.tsx","../src/useEventListener.ts","../src/google-photo.tsx"],"sourcesContent":["import React from 'react';\n\ninterface IconProps {\n  className?: string;\n}\n\nexport function CloseArrow({ className, ...props }: IconProps) {\n  return (\n    <div className={className} {...props}>\n      <svg fill=\"#ffffff\" width=\"24px\" height=\"24px\" viewBox=\"0 0 24 24\">\n        <path d=\"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\" />\n      </svg>\n    </div>\n  );\n}\n\nexport function PrevArrowButton({ className, ...props }: IconProps) {\n  return (\n    <div className={className} {...props}>\n      <svg fill=\"#ffffff\" width=\"36px\" height=\"36px\" viewBox=\"0 0 24 24\">\n        <path d=\"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z\" />\n      </svg>\n    </div>\n  );\n}\n\nexport function NextArrowButton({ className, ...props }: IconProps) {\n  return (\n    <div className={className} {...props}>\n      <svg fill=\"#ffffff\" width=\"36px\" height=\"36px\" viewBox=\"0 0 24 24\">\n        <path d=\"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z\" />\n      </svg>\n    </div>\n  );\n}\n","import { useRef, useEffect } from 'react';\n\n// Inspired by https://usehooks.com/useEventListener/\n\nexport const useEventListener = <T>(\n  active: boolean,\n  eventName: string,\n  handler: (event: T) => void,\n  element: any\n) => {\n  // Create a ref that stores handler\n  const savedHandler = useRef<(event: T) => void>();\n\n  // Update ref.current value if handler changes.\n  // This allows our effect below to always get latest handler ...\n  // ... without us needing to pass it in effect deps array ...\n  // ... and potentially cause effect to re-run every render.\n  useEffect(() => {\n    savedHandler.current = handler;\n  }, [handler]);\n\n  useEffect(\n    () => {\n      if (!element || !element.addEventListener) {\n        return;\n      }\n\n      // Create event listener that calls handler function stored in ref\n      const eventListener = (event: T) => savedHandler.current!(event);\n\n      if (active) {\n        // Add event listener\n        element.addEventListener(eventName, eventListener);\n      }\n\n      // Remove event listener on cleanup\n      return () => {\n        element.removeEventListener(eventName, eventListener);\n      };\n    },\n    // Re-run if eventName or element changes\n    [active, eventName, element]\n  );\n};\n","import React, { useState, useRef, useEffect, CSSProperties } from 'react';\nimport ReactDom from 'react-dom';\nimport noScroll from 'no-scroll';\nimport cx from 'classnames';\nimport screenfull from 'screenfull';\nimport { CloseArrow, PrevArrowButton, NextArrowButton } from './arrow';\nimport { useEventListener } from './useEventListener';\n\nconst keycodes = {\n  esc: 27,\n  left: 37,\n  right: 39,\n};\n\nconst classes = {\n  overlay: 'react-google-photo-overlay',\n  column: 'react-google-photo-column',\n  leftColumn: 'react-google-photo-left-column',\n  rightColumn: 'react-google-photo-right-column',\n  arrowButton: 'react-google-photo-arrow-button',\n  arrowButtonHide: 'react-google-photo-arrow-button-hide',\n  arrowButtonLeft: 'react-google-photo-arrow-button-left',\n  arrowButtonRight: 'react-google-photo-arrow-button-right',\n  arrowButtonReturn: 'react-google-photo-arrow-button-return',\n  image: 'react-google-photo-overlay-image',\n  imageOpen: 'react-google-photo-overlay-image-open',\n  animationIn: 'react-google-photo-fade-in',\n  animationOut: 'react-google-photo-fade-out',\n};\n\nconst isBrowser = typeof window !== 'undefined';\n\nenum Direction {\n  Prev,\n  Next,\n}\n\ninterface GooglePhotoProps {\n  /**\n   * Control if GooglePhoto is open or not.\n   */\n  open: boolean;\n  /**\n   * An array containing valid images\n   */\n  src: {\n    /**\n     * Url of the media.\n     */\n    src: string;\n    /**\n     * Height of the media.\n     */\n    height: number;\n    /**\n     * Width of the media.\n     */\n    width: number;\n    /**\n     * Alt of the media.\n     */\n    alt?: string;\n  }[];\n  /**\n   * Index of source to display.\n   */\n  srcIndex?: number;\n  /**\n   * Should open on fullscreen mode.\n   * Default to false.\n   */\n  fullscreen?: boolean;\n  /**\n   * Enable left and right arrow navigation.\n   * Default to true.\n   */\n  keyboardNavigation?: boolean;\n  /**\n   * Should close when user press esc key.\n   * Default to true.\n   */\n  closeOnEsc?: boolean;\n  /**\n   * Timeout before hidding the actions buttons when mouse do not move (milliseconds).\n   * Default to 5000.\n   */\n  mouseIdleTimeout?: number;\n  /**\n   * Animation duration in milliseconds.\n   * Default to 250.\n   */\n  animationDuration?: number;\n  /**\n   * An object containing classNames to style the lightbox.\n   */\n  classNames?: {\n    overlay?: string;\n    image?: string;\n    animationIn?: string;\n    animationOut?: string;\n  };\n  /**\n   * Function called when GooglePhoto is requested to be closed.\n   */\n  onClose: () => void;\n  /**\n   * Function called when the index of the displayed image is changing.\n   */\n  onChangeIndex?: (index: number) => void;\n}\n\nexport const GooglePhoto = ({\n  open,\n  src,\n  srcIndex: srcIndexProp = 0,\n  fullscreen,\n  keyboardNavigation = true,\n  closeOnEsc = true,\n  mouseIdleTimeout = 5000,\n  animationDuration = 250,\n  classNames,\n  onClose,\n  onChangeIndex,\n}: GooglePhotoProps) => {\n  const refContainer = useRef<HTMLDivElement | null>(null);\n  const refTimeoutMouseIdle = useRef<NodeJS.Timeout | null>(null);\n  const [showPortal, setShowPortal] = useState(open);\n  const [windowSizes, setWindowSizes] = useState<{\n    width: number;\n    height: number;\n  }>({\n    width: isBrowser ? window.innerWidth : 0,\n    height: isBrowser ? window.innerHeight : 0,\n  });\n  const [mouseIdle, setMouseIdle] = useState(false);\n  const [srcIndex, setSrcIndex] = useState(srcIndexProp);\n\n  // Lazily create the ref instance\n  // https://reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily\n  if (refContainer.current === null && isBrowser) {\n    refContainer.current = document.createElement('div');\n  }\n\n  const handleOpen = () => {\n    noScroll.on();\n    window.addEventListener('resize', handleWindowResize);\n    if (refContainer.current && !document.body.contains(refContainer.current)) {\n      document.body.appendChild(refContainer.current);\n    }\n    if (fullscreen && screenfull.isEnabled) {\n      screenfull.request();\n      screenfull.on('change', handleScreenfullChange);\n    }\n  };\n\n  const handleClose = () => {\n    window.removeEventListener('resize', handleWindowResize);\n    if (refContainer.current && document.body.contains(refContainer.current)) {\n      document.body.removeChild(refContainer.current);\n    }\n    if (screenfull.isEnabled) {\n      screenfull.exit();\n      screenfull.off('change', handleScreenfullChange);\n    }\n    noScroll.off();\n  };\n\n  const handleKeydown = (e: KeyboardEvent) => {\n    if (e.keyCode === keycodes.left && keyboardNavigation) {\n      handleChangeIndex(Direction.Prev);\n    } else if (e.keyCode === keycodes.right && keyboardNavigation) {\n      handleChangeIndex(Direction.Next);\n    } else if (e.keyCode === keycodes.esc && closeOnEsc) {\n      onClose();\n    }\n  };\n\n  useEventListener(\n    open,\n    'keydown',\n    handleKeydown,\n    isBrowser ? document : undefined\n  );\n\n  const handleMousemove = () => {\n    // Hide the actions buttons when move do not move for x seconds\n    if (refTimeoutMouseIdle.current) {\n      clearTimeout(refTimeoutMouseIdle.current);\n    }\n    if (mouseIdle === true) {\n      setMouseIdle(false);\n    }\n    refTimeoutMouseIdle.current = setTimeout(() => {\n      setMouseIdle(true);\n    }, mouseIdleTimeout);\n  };\n\n  useEventListener(\n    open,\n    'mousemove',\n    handleMousemove,\n    isBrowser ? document.querySelector('*')! : undefined\n  );\n\n  // We listen to the srcIndexProp to update the internal state if the user manage the component\n  useEffect(() => {\n    setSrcIndex(srcIndexProp);\n  }, [srcIndexProp]);\n\n  useEffect(() => {\n    // When the modal is rendered first time we want to block the scroll\n    if (open) {\n      handleOpen();\n    }\n    return () => {\n      // When the component is unmounted directly we want to unblock the scroll\n      if (showPortal) {\n        handleClose();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    // If the open prop is changing, we need to open the modal\n    if (open && !showPortal) {\n      setShowPortal(true);\n      handleOpen();\n    }\n  }, [open]);\n\n  const handleScreenfullChange = () => {\n    if (screenfull.isEnabled && !screenfull.isFullscreen && open) {\n      onClose();\n    }\n  };\n\n  const handleWindowResize = () => {\n    setWindowSizes({ width: window.innerWidth, height: window.innerHeight });\n  };\n\n  const handleChangeIndex = (direction: Direction) => {\n    if (direction === Direction.Prev && srcIndex !== 0) {\n      const newIndex = srcIndex - 1;\n      onChangeIndex ? onChangeIndex(newIndex) : setSrcIndex(newIndex);\n    } else if (direction === Direction.Next && src[srcIndex + 1]) {\n      const newIndex = srcIndex + 1;\n      onChangeIndex ? onChangeIndex(newIndex) : setSrcIndex(newIndex);\n    }\n  };\n\n  const handleClickCloseArrow = () => {\n    onClose();\n  };\n\n  const handleAnimationEnd = () => {\n    if (!open) {\n      setShowPortal(false);\n      handleClose();\n    }\n\n    // if (onAnimationEnd) {\n    //   onAnimationEnd();\n    // }\n  };\n\n  const image = src[srcIndex];\n  const wrapperImageStyle: CSSProperties = {\n    position: 'absolute',\n    overflow: 'hidden',\n    userSelect: 'none',\n  };\n  let imageWidth = image.width;\n  let imageHeight = image.height;\n  // Adjust image ratio max with window size\n  if (imageWidth > windowSizes.width) {\n    const ratio = windowSizes.width / imageWidth;\n    imageHeight *= ratio;\n    imageWidth *= ratio;\n  }\n  if (imageHeight > windowSizes.height) {\n    const ratio = windowSizes.height / imageHeight;\n    imageHeight *= ratio;\n    imageWidth *= ratio;\n  }\n\n  if (imageHeight > imageWidth || imageWidth < windowSizes.width) {\n    wrapperImageStyle.left = (windowSizes.width - imageWidth) / 2;\n    wrapperImageStyle.height = windowSizes.height;\n    wrapperImageStyle.width = imageWidth;\n  } else {\n    wrapperImageStyle.top = (windowSizes.height - imageHeight) / 2;\n    wrapperImageStyle.height = imageHeight;\n    wrapperImageStyle.width = windowSizes.width;\n  }\n  if (windowSizes.height > imageHeight) {\n    wrapperImageStyle.height = imageHeight;\n    wrapperImageStyle.top = (windowSizes.height - imageHeight) / 2;\n  } else if (windowSizes.width > imageWidth) {\n    wrapperImageStyle.height = windowSizes.height;\n    wrapperImageStyle.left = (windowSizes.width - imageWidth) / 2;\n  }\n\n  return showPortal && refContainer.current\n    ? ReactDom.createPortal(\n        <div\n          className={cx(classes.overlay, classNames?.overlay)}\n          style={{\n            animation: `${\n              open\n                ? classNames?.animationIn ?? classes.animationIn\n                : classNames?.animationOut ?? classes.animationOut\n            } ${animationDuration}ms`,\n          }}\n          onAnimationEnd={handleAnimationEnd}\n        >\n          <div style={wrapperImageStyle}>\n            {src.map((source, index) => (\n              <img\n                key={index}\n                src={source.src}\n                alt={source.alt}\n                width={wrapperImageStyle.width}\n                height={wrapperImageStyle.height}\n                className={cx(classes.image, classNames?.image, {\n                  [classes.imageOpen]: index === srcIndex,\n                })}\n              />\n            ))}\n          </div>\n          {srcIndex !== 0 && (\n            <div\n              className={cx(classes.column, classes.leftColumn)}\n              onClick={() => handleChangeIndex(Direction.Prev)}\n            >\n              <PrevArrowButton\n                className={cx(classes.arrowButton, classes.arrowButtonLeft, {\n                  [classes.arrowButtonHide]: mouseIdle,\n                })}\n              />\n            </div>\n          )}\n          {src[srcIndex + 1] && (\n            <div\n              className={cx(classes.column, classes.rightColumn)}\n              onClick={() => handleChangeIndex(Direction.Next)}\n            >\n              <NextArrowButton\n                className={cx(classes.arrowButton, classes.arrowButtonRight, {\n                  [classes.arrowButtonHide]: mouseIdle,\n                })}\n              />\n            </div>\n          )}\n          <div onClick={handleClickCloseArrow}>\n            <CloseArrow\n              className={cx(classes.arrowButtonReturn, {\n                [classes.arrowButtonHide]: mouseIdle,\n              })}\n            />\n          </div>\n        </div>,\n        refContainer.current\n      )\n    : null;\n};\n"],"names":["CloseArrow","className","props","React","fill","width","height","viewBox","d","PrevArrowButton","NextArrowButton","useEventListener","active","eventName","handler","element","savedHandler","useRef","useEffect","current","addEventListener","eventListener","event","removeEventListener","keycodes","esc","left","right","classes","overlay","column","leftColumn","rightColumn","arrowButton","arrowButtonHide","arrowButtonLeft","arrowButtonRight","arrowButtonReturn","image","imageOpen","animationIn","animationOut","isBrowser","window","Direction","GooglePhoto","open","src","srcIndex","srcIndexProp","fullscreen","keyboardNavigation","closeOnEsc","mouseIdleTimeout","animationDuration","classNames","onClose","onChangeIndex","refContainer","refTimeoutMouseIdle","useState","showPortal","setShowPortal","innerWidth","innerHeight","windowSizes","setWindowSizes","mouseIdle","setMouseIdle","setSrcIndex","document","createElement","handleOpen","noScroll","on","handleWindowResize","body","contains","appendChild","screenfull","isEnabled","request","handleScreenfullChange","handleClose","removeChild","exit","off","handleKeydown","e","keyCode","handleChangeIndex","Prev","Next","undefined","handleMousemove","clearTimeout","setTimeout","querySelector","isFullscreen","direction","newIndex","handleClickCloseArrow","handleAnimationEnd","wrapperImageStyle","position","overflow","userSelect","imageWidth","imageHeight","ratio","top","ReactDom","createPortal","cx","style","animation","onAnimationEnd","map","source","index","key","alt","onClick"],"mappings":"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"}